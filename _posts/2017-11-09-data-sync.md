---
layout: post
title: 数据同步
date: 2017-11-10
tags: Design
---
## 数据同步（mysql为例）
- 为什么数据同步
  - 数据存储在mysql，如果我们需要拿这些数据做别的事情：
    - 订单列表搜索
    - 报表统计系统
    - 用户画像
    - 其它离线相关数据分析
    - 以上情况，很可能涉及多表复杂操作，我们不会去直接操作数据库，而是同步数据到es，hbase,hive之类，专门处理复杂搜索,计算等相关逻辑，达到不影响线上实际业务；
  -
- 怎么同步
  - 目前使用较多，比较成熟的方案是：基于数据库日志增量日志订阅消费同步；
    - mysql日志文件（redo.log,undo.log,binlog ）,数据同步使用的 binlog,具体区别看 [这篇](https://bamboog.github.io/2017/09/mysql_log/)；
    - mysql已有同步模式： master-slave 模式:
    ![](https://bamboog.github.io/images/mysql/mysql_master_slave.png)
    - 模仿slave--canal开源
    （[canal架构](https://bamboog.github.io/2017/09/canal/)）:
    ![](https://bamboog.github.io/images/mysql/mysql_canal.png)

    -
  - 也有其它做法，譬如基于trigger,redis,zk等做相关同步--后续文章介绍
- 落地方案
